# jcglobeway 팀 - 개발 규칙

## 🎯 프로젝트 개요
- 이 프로젝트는 **이슈 기반 개발 워크플로우**를 따릅니다
- **GitHub CLI**를 활용한 이슈/PR 관리를 권장합니다
- 모든 커밋 메시지는 **한글**로 작성합니다
- Git Flow 전략을 기반으로 브랜치를 관리합니다

## 📋 Git 워크플로우

### 1. 기능 개발 시작
- 새로운 작업 시작 전 **반드시 이슈를 먼저 생성**합니다
- 이슈 번호를 기반으로 브랜치를 생성합니다
- **브랜치 네이밍 규칙**:
  - `feature/ISSUE-{번호}` : 새로운 기능 개발
  - `bugfix/ISSUE-{번호}` : 버그 수정
  - `hotfix/ISSUE-{번호}` : 긴급 수정
  - `chore/ISSUE-{번호}` : 설정/빌드/환경 작업
  - 예시: `feature/ISSUE-123`, `bugfix/ISSUE-45`

### 2. 커밋 메시지 규칙
**형식**: `[작업종류] 상세 내용 (#이슈번호)`

**작업 종류 (Prefix)**:
- `feat` : 새로운 기능 추가
- `fix` : 버그 수정
- `refactor` : 코드 리팩토링 (기능 변화 없음)
- `chore` : 설정/빌드/환경 작업
- `docs` : 문서 수정
- `test` : 테스트 추가 또는 수정
- `style` : 코드 포맷팅, 세미콜론 누락 등

**예시**:
```
[feat] 사용자 로그인 API 추가 (#123)

- JWT 기반 인증 구현
- 로그인 실패 시 에러 처리 추가
- 관련 테스트 코드 작성
```

**주의사항**:
- 이슈 번호는 필수 (#이슈번호)
- 커밋 본문에는 '무엇을', '왜' 변경했는지 명확히 작성
- 한 커밋에는 하나의 논리적 변경사항만 포함

### 3. Pull Request 규칙
- **PR 제목 형식**: `[ISSUE-{번호}] 기능명`
  - 예시: `[ISSUE-123] 사용자 인증 기능 구현`
- **타겟 브랜치**: `develop` (기본)
- **머지 방식**: Squash and merge
- **승인 조건**: 최소 1명 이상 리뷰 승인 필요
- **머지 조건**: 모든 CI 테스트 통과 필수

**PR 본문 템플릿**:
```markdown
## 📌 작업 내용
- 주요 변경점을 bullet point로 요약

## 🔗 관련 이슈
- Closes #이슈번호

## 🧪 테스트 항목
- [ ] 단위 테스트 실행 완료
- [ ] 로컬 빌드 정상 동작
- [ ] API 엔드포인트 동작 확인
- [ ] 코드 리뷰 완료

## 📝 특이사항 (선택)
- 리뷰어가 주의 깊게 봐야 할 부분
```

## 코드 작성 원칙

### 일반 원칙
- 간결하고 명확한 코드 작성
- 중복 코드 최소화 (DRY 원칙)
- 함수는 하나의 책임만 가지도록 작성 (SRP)
- 매직 넘버/문자열 사용 금지 → 상수로 정의
- 의미 있는 변수명 사용 (축약어 지양)

### TypeScript/NestJS 스타일
- interface 우선, type은 union/intersection 필요시에만 사용
- enum은 대문자 스네이크 케이스 사용
- DTO 클래스는 class-validator 데코레이터와 함께 작성
- Service 레이어에 비즈니스 로직 집중
- Controller는 얇게 유지 (요청/응답 처리만)
- 의존성 주입(DI) 적극 활용

### 네이밍 컨벤션
- 파일명: kebab-case (user-service.ts)
- 클래스명: PascalCase (UserService)
- 함수/변수명: camelCase (getUserById)
- 상수: UPPER_SNAKE_CASE (MAX_RETRY_COUNT)
- Private 메서드: 접두사 없이 명확한 이름 사용

## 에러 처리
- try-catch는 필요한 곳에만 사용
- 의미 있는 에러 메시지 작성
- NestJS HttpException 활용
- 에러 로그는 상세하게, 사용자 메시지는 간결하게
- 예외 상황을 먼저 처리 (Early Return)

## 로깅
- 중요한 비즈니스 로직 시작/종료 시점 로깅
- 민감 정보(비밀번호, 토큰 등) 로그 출력 금지
- 로그 레벨 적절히 사용:
  - error: 시스템 오류
  - warn: 잠재적 문제
  - info: 주요 비즈니스 이벤트
  - debug: 개발 디버깅 정보

## 비동기 처리
- async/await 사용 (Promise.then 지양)
- 병렬 처리 가능한 작업은 Promise.all 활용
- 에러 핸들링 누락 방지

## 테스트
- 단위 테스트는 AAA 패턴 (Arrange, Act, Assert)
- 테스트 함수명: 한글로 명확하게 (예: '사용자 ID로 조회 시 사용자 정보를 반환한다')
- Mock 객체는 최소한으로 사용
- E2E 테스트는 핵심 플로우 위주로 작성

## 주석
- 코드로 설명 가능한 부분은 주석 대신 리팩토링
- 복잡한 비즈니스 로직에만 주석 작성
- 주석은 '왜'를 설명 ('무엇'은 코드로 표현)
- TODO 주석에는 담당자와 날짜 포함

## 금지 사항
- console.log 사용 금지 (로거 사용)
- any 타입 사용 최소화
- 하드코딩된 값 사용 금지
- 불필요한 else 문 (Early Return 활용)
- 깊은 중첩 (3depth 이상) 지양

## 🌿 Git 브랜치 전략
- `main`: 운영 배포 브랜치 (프로덕션)
- `develop`: 개발 통합 브랜치 (다음 릴리즈 준비)
- `feature/ISSUE-{번호}`: 기능 개발 브랜치
- `bugfix/ISSUE-{번호}`: 버그 수정 브랜치
- `hotfix/ISSUE-{번호}`: 긴급 수정 브랜치 (main에서 분기)
- `chore/ISSUE-{번호}`: 설정/빌드 작업 브랜치

**브랜치 생성 예시**:
```bash
# 이슈 생성
gh issue create -t "사용자 로그인 기능 구현" -b "JWT 기반 인증 시스템" -l feature

# 브랜치 생성 (이슈 번호가 123인 경우)
git checkout develop
git pull origin develop
git checkout -b feature/ISSUE-123
```

## 🤖 AI 어시스턴트 지침

### 코드 작성 시
1. **커밋 메시지**: 반드시 **한글**로 작성하고 이슈 번호 포함 (#이슈번호)
2. **이슈 기반 개발**: 항상 관련 이슈 번호를 확인하고 언급
3. **작업 단위**: 한 PR에는 한 이슈만 처리하도록 권장
4. **테스트 작성**: 새로운 기능은 테스트 코드와 함께 작성

### Git 명령어 제안 시
1. **브랜치 생성**: `feature/ISSUE-{번호}` 형식 준수
2. **GitHub CLI 우선 사용**:
   - 이슈 생성: `gh issue create -t "제목" -b "설명" -l feature`
   - PR 생성: `gh pr create -B develop -H {브랜치명} -t "[ISSUE-{번호}] 제목" -b "본문"`
3. **커밋 전 확인**: 관련 이슈가 있는지 확인하고 없으면 생성 권장

### PR 생성 시
1. PR 본문에 `Closes #{이슈번호}` 포함하여 자동 이슈 종료 설정
2. 변경 사항을 명확하게 요약
3. 테스트 체크리스트 포함
4. 리뷰어가 주의해야 할 부분 명시

### 이슈 관리 시
1. PR이 머지된 후 추가 수정사항이 발생하면, 새로운 이슈를 생성하거나 원본 이슈의 코멘트로 업데이트

## 📝 개발 원칙
- **한 PR = 한 이슈**: 여러 이슈를 하나의 PR에 포함하지 않습니다
- **작은 단위 커밋**: 의미 있는 단위로 자주 커밋합니다
- **코드 리뷰 필수**: 모든 코드는 리뷰를 거쳐야 합니다
- **테스트 작성**: 새로운 기능은 테스트 코드와 함께 작성합니다
- **이슈 먼저**: 코드 작성 전 이슈를 먼저 생성하여 작업 내용을 명확히 합니다

## 🔒 보안 및 주의사항
- **민감 정보 금지**: API 키, 비밀번호, 토큰 등은 절대 커밋하지 않습니다
- **환경 변수 사용**: 민감한 설정은 `.env` 파일에 저장하고 `.gitignore`에 추가
- **.gitignore 준수**: 설정된 파일들은 절대 커밋하지 않습니다
- **코드 포맷팅**: 프로젝트 설정(Prettier, ESLint 등)을 따릅니다
- **의존성 관리**: `package.json` 업데이트 시 `package-lock.json`도 함께 커밋

## 🎓 참고 자료
- GitHub CLI 문서: https://cli.github.com/manual/
- Git Flow 전략: https://nvie.com/posts/a-successful-git-branching-model/
- 팀 위키: [프로젝트별 위키 링크]
